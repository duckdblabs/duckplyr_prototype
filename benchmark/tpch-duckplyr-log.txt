> library(commandArgs(TRUE)[1], character.only=T)
> 
> test_dplyr_q <- list()
> 
> tables <- c("lineitem", "partsupp", "part", "supplier", "nation", "orders", "customer", "region")
> env <- environment()
> lapply(tables, function(t) {
+   assign(t, readRDS(paste0(t, ".rds")), env=env)
+   NULL
+ })
[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL

[[5]]
NULL

[[6]]
NULL

[[7]]
NULL

[[8]]
NULL

> 
> 
> test_dplyr_q[[1]] <- function() {
+   lineitem |>
+     select(l_shipdate, l_returnflag, l_linestatus, l_quantity, 
+         l_extendedprice, l_discount, l_tax) |>
+     filter(l_shipdate <= "1998-09-02") |>
+     select(l_returnflag, l_linestatus, l_quantity, l_extendedprice, l_discount, l_tax) |>
+     group_by(l_returnflag, l_linestatus) |>
+     summarise(
+       sum_qty = sum(l_quantity),
+       sum_base_price = sum(l_extendedprice),
+       sum_disc_price = sum(l_extendedprice * (1 - l_discount)),
+       sum_charge = sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)),
+       avg_qty = mean(l_quantity),
+       avg_price = mean(l_extendedprice),
+       avg_disc = mean(l_discount),
+       count_order = n()
+     ) |>
+     arrange(l_returnflag, l_linestatus)
+ }
> 
> test_dplyr_q[[2]] <- function() {
+   ps <- partsupp |> select(ps_partkey, ps_suppkey, ps_supplycost)
+ 
+   p <- part |>
+     select(p_partkey, p_type, p_size, p_mfgr) |>
+     filter(p_size == 15, grepl(".*BRASS$", p_type)) |>
+     select(p_partkey, p_mfgr)
+ 
+   psp <- inner_join(ps, p, by = c("ps_partkey" = "p_partkey"))
+ 
+   sp <- supplier |>
+     select(s_suppkey, s_nationkey, s_acctbal, s_name, 
+         s_address, s_phone, s_comment)
+ 
+   psps <- inner_join(psp, sp,
+     by = c("ps_suppkey" = "s_suppkey")) |> 
+     select(ps_partkey, ps_supplycost, p_mfgr, s_nationkey, 
+         s_acctbal, s_name, s_address, s_phone, s_comment)
+ 
+   nr <- inner_join(nation,
+     region |> filter(r_name == "EUROPE"), 
+     by = c("n_regionkey" = "r_regionkey")) |> 
+     select(n_nationkey, n_name)
+   
+   pspsnr <- inner_join(psps, nr, 
+     by = c("s_nationkey" = "n_nationkey")) |> 
+   select(ps_partkey, ps_supplycost, p_mfgr, n_name, s_acctbal, 
+     s_name, s_address, s_phone, s_comment)
+ 
+   aggr <- pspsnr |>
+     group_by(ps_partkey) |>
+     summarise(min_ps_supplycost = min(ps_supplycost))
+ 
+   sj <- inner_join(pspsnr, aggr, 
+     by=c("ps_partkey" = "ps_partkey", "ps_supplycost" = "min_ps_supplycost"))
+ 
+ 
+   res <- sj |>
+     select(s_acctbal, s_name, n_name, ps_partkey, p_mfgr, 
+         s_address, s_phone, s_comment) |>
+         # TODO
+     #arrange(desc(s_acctbal), n_name, s_name, ps_partkey) |>
+       arrange(s_acctbal, n_name, s_name, ps_partkey) |>
+ 
+     head(100)
+ 
+   res
+ }
> 
> test_dplyr_q[[3]] <- function() {
+   oc <- inner_join(
+     orders |>
+       select(o_orderkey, o_custkey, o_orderdate, o_shippriority) |>
+       filter(o_orderdate < "1995-03-15"),
+     customer |>
+       select(c_custkey, c_mktsegment) |>
+       filter(c_mktsegment == "BUILDING"),
+     by = c("o_custkey" = "c_custkey")
+   ) |>
+     select(o_orderkey, o_orderdate, o_shippriority)
+ 
+   loc <- inner_join(
+     lineitem |>
+       select(l_orderkey, l_shipdate, l_extendedprice, l_discount) |>
+       filter(l_shipdate > "1995-03-15") |>
+       select(l_orderkey, l_extendedprice, l_discount),
+     oc, by = c("l_orderkey" = "o_orderkey")
+   )
+ 
+   aggr <- loc |> mutate(volume=l_extendedprice * (1 - l_discount)) |>
+     group_by(l_orderkey, o_orderdate, o_shippriority) |>
+     summarise(revenue = sum(volume)) |>
+     select(l_orderkey, revenue, o_orderdate, o_shippriority) |>
+         #arrange(desc(revenue), o_orderdate) |>
+     arrange(revenue, o_orderdate) |>
+     head(10)
+   aggr
+ }
> 
> test_dplyr_q[[4]] <- function() {
+   l <- lineitem |>
+     select(l_orderkey, l_commitdate, l_receiptdate) |>
+     filter(l_commitdate < l_receiptdate) |>
+     select(l_orderkey)
+ 
+   o <- orders |>
+     select(o_orderkey, o_orderdate, o_orderpriority) |>
+     filter(o_orderdate >= "1993-07-01", o_orderdate < "1993-10-01") |>
+     select(o_orderkey, o_orderpriority)
+ 
+   # distinct after join, tested and indeed faster
+   lo <- inner_join(l, o, by = c("l_orderkey" = "o_orderkey")) |>
+     distinct() |>
+     select(o_orderpriority)
+ 
+   aggr <- lo |>
+     group_by(o_orderpriority) |>
+     summarise(order_count = n()) |>
+     arrange(o_orderpriority)
+   
+   aggr
+ }
> 
> test_dplyr_q[[5]] <- function() {
+   nr <- inner_join(
+     nation |>
+       select(n_nationkey, n_regionkey, n_name),
+     region |>
+       select(r_regionkey, r_name) |>
+       filter(r_name == "ASIA"),
+     by = c("n_regionkey" = "r_regionkey")
+   ) |>
+     select(n_nationkey, n_name)
+ 
+   snr <- inner_join(
+     supplier |>
+       select(s_suppkey, s_nationkey),
+     nr,
+     by = c("s_nationkey" = "n_nationkey")
+   ) |>
+     select(s_suppkey, s_nationkey, n_name)
+ 
+   lsnr <- inner_join(
+     lineitem |> select(l_suppkey, l_orderkey, l_extendedprice, l_discount), 
+     snr, by = c("l_suppkey" = "s_suppkey"))
+ 
+   o <- orders |> 
+     select(o_orderdate, o_orderkey, o_custkey) |> 
+     filter(o_orderdate >= "1994-01-01", o_orderdate < "1995-01-01") |> 
+     select(o_orderkey, o_custkey)
+ 
+   oc <- inner_join(o, customer |> select(c_custkey, c_nationkey), 
+     by = c("o_custkey" = "c_custkey")) |> 
+   select(o_orderkey, c_nationkey)
+ 
+   lsnroc <- inner_join(lsnr, oc, 
+     by = c("l_orderkey" = "o_orderkey", "s_nationkey" = "c_nationkey")) |> 
+   select(l_extendedprice, l_discount, n_name)
+ 
+   aggr <- lsnroc |>
+     mutate(volume=l_extendedprice * (1 - l_discount)) |>
+     group_by(n_name) |>
+     summarise(revenue = sum(volume)) |>
+     #arrange(desc(revenue)) # TODO
+     arrange(revenue)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[6]] <- function() {
+   lineitem |>
+     select(l_shipdate, l_extendedprice, l_discount, l_quantity) |>
+     filter(l_shipdate >= "1994-01-01", 
+         l_shipdate < "1995-01-01", 
+         l_discount >= 0.05, 
+         l_discount <= 0.07, 
+         l_quantity < 24) |>
+     select(l_extendedprice, l_discount) |>
+     summarise(revenue = sum(l_extendedprice * l_discount))
+ }
> 
> test_dplyr_q[[7]] <- function() {
+   sn <- inner_join(
+     supplier |> 
+         select(s_nationkey, s_suppkey), 
+     nation |> 
+         select(n1_nationkey = n_nationkey, n1_name = n_name) |> 
+         #filter(n1_name %in% c("FRANCE", "GERMANY")),  TODO
+         filter(n1_name == "FRANCE" || n1_name == "GERMANY"),
+     by = c("s_nationkey" = "n1_nationkey")) |> 
+     select(s_suppkey, n1_name)
+ 
+   cn <- inner_join(
+     customer |> 
+         select(c_custkey, c_nationkey), 
+     nation |> 
+         select(n2_nationkey = n_nationkey, n2_name = n_name) |> 
+         #filter(n2_name %in% c("FRANCE", "GERMANY")),
+         filter(n2_name == "FRANCE" || n2_name == "GERMANY"),
+     by = c("c_nationkey" = "n2_nationkey")) |> 
+     select(c_custkey, n2_name)
+ 
+   cno <- inner_join(
+     orders |> 
+         select(o_custkey, o_orderkey), 
+     cn, by = c("o_custkey" = "c_custkey")) |> 
+     select(o_orderkey, n2_name)
+ 
+   cnol <- inner_join(
+     lineitem |> 
+         select(l_orderkey, l_suppkey, l_shipdate, l_extendedprice, l_discount) |> 
+         filter(l_shipdate >= "1995-01-01", l_shipdate <= "1996-12-31"), 
+     cno, 
+     by = c("l_orderkey" = "o_orderkey")) |> 
+     select(l_suppkey, l_shipdate, l_extendedprice, l_discount, n2_name)
+ 
+   all <- inner_join(cnol, sn, by = c("l_suppkey" = "s_suppkey"))
+ 
+   aggr <- all |>
+     filter((n1_name == "FRANCE" & n2_name == "GERMANY") |
+         (n1_name == "GERMANY" & n2_name == "FRANCE")) |>
+     mutate(
+         supp_nation = n1_name, 
+         cust_nation = n2_name, 
+         l_year = as.integer(strftime(l_shipdate, "%Y")),
+         volume = l_extendedprice * (1 - l_discount)) |>
+     select(supp_nation, cust_nation, l_year, volume) |>
+     group_by(supp_nation, cust_nation, l_year) |>
+     summarise(revenue = sum(volume)) |>
+     arrange(supp_nation, cust_nation, l_year)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[8]] <- function() {
+   nr <- inner_join(
+     nation |> 
+         select(n1_nationkey = n_nationkey, n1_regionkey = n_regionkey), 
+     region |> 
+         select(r_regionkey, r_name) |> 
+         filter(r_name == "AMERICA") |> 
+         select(r_regionkey), 
+     by = c("n1_regionkey" = "r_regionkey")) |> 
+     select(n1_nationkey)
+ 
+   cnr <- inner_join(
+     customer |> 
+         select(c_custkey, c_nationkey), 
+         nr, by = c("c_nationkey" = "n1_nationkey")) |> 
+     select(c_custkey)
+   
+   ocnr <- inner_join(
+     orders |> 
+         select(o_orderkey, o_custkey, o_orderdate) |> 
+         filter(o_orderdate >= "1995-01-01", o_orderdate <= "1996-12-31"), 
+     cnr, by = c("o_custkey" = "c_custkey")) |> 
+     select(o_orderkey, o_orderdate)
+ 
+   locnr <- inner_join(
+     lineitem |> 
+         select(l_orderkey, l_partkey, l_suppkey, l_extendedprice, l_discount), 
+         ocnr, by=c("l_orderkey" = "o_orderkey")) |> 
+     select(l_partkey, l_suppkey, l_extendedprice, l_discount, o_orderdate)
+ 
+   locnrp <- inner_join(locnr, 
+     part |> 
+         select(p_partkey, p_type) |> 
+         filter(p_type == "ECONOMY ANODIZED STEEL") |> 
+         select(p_partkey), 
+     by = c("l_partkey" = "p_partkey")) |> 
+     select(l_suppkey, l_extendedprice, l_discount, o_orderdate)
+ 
+   locnrps <- inner_join(locnrp, 
+     supplier |> 
+         select(s_suppkey, s_nationkey), 
+     by = c("l_suppkey" = "s_suppkey")) |> 
+     select(l_extendedprice, l_discount, o_orderdate, s_nationkey)
+ 
+   all <- inner_join(locnrps, 
+     nation |> 
+         select(n2_nationkey = n_nationkey, n2_name = n_name), 
+     by = c("s_nationkey" = "n2_nationkey")) |> 
+     select(l_extendedprice, l_discount, o_orderdate, n2_name)
+ 
+   aggr <- all |>
+     mutate(
+         o_year = as.integer(strftime(o_orderdate, "%Y")),
+         volume = l_extendedprice * (1 - l_discount), 
+         nation = n2_name) |>
+     select(o_year, volume, nation) |>
+     group_by(o_year) |>
+     summarise(mkt_share = sum(ifelse(nation == "BRAZIL", volume, 0)) / sum(volume)) |>
+     arrange(o_year)
+   aggr
+ }
> 
> test_dplyr_q[[9]] <- function() {
+   p <- part |> 
+     select(p_name, p_partkey) |> 
+     filter(grepl(".*green.*", p_name)) |>
+     select(p_partkey)
+ 
+   psp <- inner_join(
+     partsupp |> 
+         select(ps_suppkey, ps_partkey, ps_supplycost), 
+     p, by = c("ps_partkey" = "p_partkey"))
+ 
+   sn <- inner_join(
+     supplier |> 
+         select(s_suppkey, s_nationkey), 
+     nation |> 
+         select(n_nationkey, n_name), 
+     by = c("s_nationkey" = "n_nationkey")) |> 
+     select(s_suppkey, n_name)
+ 
+   pspsn <- inner_join(psp, sn, by = c("ps_suppkey" = "s_suppkey"))
+ 
+   lpspsn <- inner_join(
+     lineitem |> 
+         select(l_suppkey, l_partkey, l_orderkey, l_extendedprice, l_discount, l_quantity),
+     pspsn, 
+     by = c("l_suppkey" = "ps_suppkey", "l_partkey" = "ps_partkey")) |> 
+     select(l_orderkey, l_extendedprice, l_discount, l_quantity, ps_supplycost, n_name)
+ 
+   all <- inner_join(
+     orders |> 
+       select(o_orderkey, o_orderdate), 
+     lpspsn,   
+     by = c("o_orderkey"= "l_orderkey" )) |> 
+     select(l_extendedprice, l_discount, l_quantity, ps_supplycost, n_name, o_orderdate)
+ 
+   aggr <- all |>
+     mutate(
+         nation = n_name, 
+         o_year = as.integer(strftime(o_orderdate, "%Y")),
+         amount = l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity) |>
+     select(nation, o_year, amount) |>
+     group_by(nation, o_year) |>
+     summarise(sum_profit = sum(amount)) |>
+     #arrange(nation, desc(o_year)) TODO
+     arrange(nation, o_year)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[10]] <- function() {
+   l <- lineitem |> 
+     select(l_orderkey, l_returnflag, l_extendedprice, l_discount) |> 
+     filter(l_returnflag == "R") |> 
+     select(l_orderkey, l_extendedprice, l_discount)
+   
+   o <- orders |> 
+     select(o_orderkey, o_custkey, o_orderdate) |> 
+     filter(o_orderdate >= "1993-10-01", o_orderdate < "1994-01-01") |> 
+     select(o_orderkey, o_custkey)
+   
+   lo <- inner_join(l, o, 
+     by = c("l_orderkey" = "o_orderkey")) |> 
+     select(l_extendedprice, l_discount, o_custkey)
+   # first aggregate, then join with customer/nation, 
+   # otherwise we need to aggr over lots of cols
+   
+   lo_aggr <- lo |> mutate(volume=l_extendedprice * (1 - l_discount)) |> 
+     group_by(o_custkey) |> 
+     summarise(revenue = sum(volume))
+   
+   c <- customer |> 
+     select(c_custkey, c_nationkey, c_name, c_acctbal, c_phone, c_address, c_comment)
+   
+   loc <- inner_join(lo_aggr, c, by = c("o_custkey" = "c_custkey"))
+   
+   locn <- inner_join(loc, nation |> select(n_nationkey, n_name), 
+     by = c("c_nationkey" = "n_nationkey"))
+   
+   res <- locn |>
+     select(o_custkey, c_name, revenue, c_acctbal, n_name, 
+         c_address, c_phone, c_comment) |>
+     #arrange(desc(revenue)) |> TODO
+         arrange(revenue) |>
+ 
+     head(20)
+   
+   res
+ }
> 
> 
> invisible(lapply(test_dplyr_q, function(f) {
+   print(f)
+   rel <- f()
+   print(rel)
+   print(duckdb::rel_explain(rel))
+   print(as.data.frame(rel))
+   NULL
+ }))
function () 
{
    arrange(summarise(group_by(select(filter(select(lineitem, 
        l_shipdate, l_returnflag, l_linestatus, l_quantity, l_extendedprice, 
        l_discount, l_tax), l_shipdate <= "1998-09-02"), l_returnflag, 
        l_linestatus, l_quantity, l_extendedprice, l_discount, 
        l_tax), l_returnflag, l_linestatus), sum_qty = sum(l_quantity), 
        sum_base_price = sum(l_extendedprice), sum_disc_price = sum(l_extendedprice * 
            (1 - l_discount)), sum_charge = sum(l_extendedprice * 
            (1 - l_discount) * (1 + l_tax)), avg_qty = mean(l_quantity), 
        avg_price = mean(l_extendedprice), avg_disc = mean(l_discount), 
        count_order = n()), l_returnflag, l_linestatus)
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ORDER_BY         â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚    dataframe_1827609411   â”‚
â”‚     .l_returnflag ASC     â”‚
â”‚    dataframe_1827609411   â”‚
â”‚     .l_linestatus ASC     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       HASH_GROUP_BY       â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚             #0            â”‚
â”‚             #1            â”‚
â”‚          sum(#2)          â”‚
â”‚          sum(#3)          â”‚
â”‚          sum(#4)          â”‚
â”‚          sum(#5)          â”‚
â”‚          avg(#6)          â”‚
â”‚          avg(#7)          â”‚
â”‚          avg(#8)          â”‚
â”‚        count_star()       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚        l_returnflag       â”‚
â”‚        l_linestatus       â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚             #4            â”‚
â”‚ *(#4, +(1.000000, l_tax)) â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚         l_discount        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚        l_returnflag       â”‚
â”‚        l_linestatus       â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚   *(l_extendedprice, -(1  â”‚
â”‚   .000000, l_discount))   â”‚
â”‚           l_tax           â”‚
â”‚         l_discount        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚        l_returnflag       â”‚
â”‚        l_linestatus       â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚         l_discount        â”‚
â”‚           l_tax           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚             #0            â”‚
â”‚             #1            â”‚
â”‚             #2            â”‚
â”‚             #3            â”‚
â”‚             #4            â”‚
â”‚             #5            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FILTER          â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚l_shipdate <= '1998-09-02':â”‚
â”‚           :DATE           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         data.frame        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚         l_discount        â”‚
â”‚           l_tax           â”‚
â”‚        l_returnflag       â”‚
â”‚        l_linestatus       â”‚
â”‚         l_shipdate        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
NULL
[38;5;246m# A tibble: 4 Ã— 10[39m
  l_returnflag l_linestatus  sum_qty sum_base_price sum_disc_price    sum_charge
  [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<chr>[39m[23m           [3m[38;5;246m<dbl>[39m[23m          [3m[38;5;246m<dbl>[39m[23m          [3m[38;5;246m<dbl>[39m[23m         [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m N            O            74[4m4[24m[4m7[24m[4m6[24m040  [4m1[24m[4m1[24m[4m1[24m701[4m7[24m[4m2[24m[4m9[24m698.  [4m1[24m[4m0[24m[4m6[24m118[4m2[24m[4m3[24m[4m0[24m308. [4m1[24m[4m1[24m[4m0[24m367[4m0[24m[4m4[24m[4m3[24m872.
[38;5;250m2[39m N            F              [4m9[24m[4m9[24m[4m1[24m417    [4m1[24m487[4m5[24m[4m0[24m[4m4[24m710.    [4m1[24m413[4m0[24m[4m8[24m[4m2[24m168.   [4m1[24m469[4m6[24m[4m4[24m[4m9[24m223.
[38;5;250m3[39m R            F            37[4m7[24m[4m1[24m[4m9[24m753   [4m5[24m[4m6[24m568[4m0[24m[4m4[24m[4m1[24m381.   [4m5[24m[4m3[24m741[4m2[24m[4m9[24m[4m2[24m685.  [4m5[24m[4m5[24m889[4m6[24m[4m1[24m[4m9[24m120.
[38;5;250m4[39m A            F            37[4m7[24m[4m3[24m[4m4[24m107   [4m5[24m[4m6[24m586[4m5[24m[4m5[24m[4m4[24m401.   [4m5[24m[4m3[24m758[4m2[24m[4m5[24m[4m7[24m135.  [4m5[24m[4m5[24m909[4m0[24m[4m6[24m[4m5[24m223.
[38;5;246m# â€¦ with 4 more variables: avg_qty <dbl>, avg_price <dbl>, avg_disc <dbl>,[39m
[38;5;246m#   count_order <dbl>[39m
function () 
{
    ps <- select(partsupp, ps_partkey, ps_suppkey, ps_supplycost)
    p <- select(filter(select(part, p_partkey, p_type, p_size, 
        p_mfgr), p_size == 15, grepl(".*BRASS$", p_type)), p_partkey, 
        p_mfgr)
    psp <- inner_join(ps, p, by = c(ps_partkey = "p_partkey"))
    sp <- select(supplier, s_suppkey, s_nationkey, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    psps <- select(inner_join(psp, sp, by = c(ps_suppkey = "s_suppkey")), 
        ps_partkey, ps_supplycost, p_mfgr, s_nationkey, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    nr <- select(inner_join(nation, filter(region, r_name == 
        "EUROPE"), by = c(n_regionkey = "r_regionkey")), n_nationkey, 
        n_name)
    pspsnr <- select(inner_join(psps, nr, by = c(s_nationkey = "n_nationkey")), 
        ps_partkey, ps_supplycost, p_mfgr, n_name, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    aggr <- summarise(group_by(pspsnr, ps_partkey), min_ps_supplycost = min(ps_supplycost))
    sj <- inner_join(pspsnr, aggr, by = c(ps_partkey = "ps_partkey", 
        ps_supplycost = "min_ps_supplycost"))
    res <- head(arrange(select(sj, s_acctbal, s_name, n_name, 
        ps_partkey, p_mfgr, s_address, s_phone, s_comment), s_acctbal, 
        n_name, s_name, ps_partkey), 100)
    res
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                               
â”‚        TOP_N        â”‚                                                                                                                                                                                                               
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                               
â”‚       Top 100       â”‚                                                                                                                                                                                                               
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                               
â”‚  relation.s_acctbal â”‚                                                                                                                                                                                                               
â”‚          ASC        â”‚                                                                                                                                                                                                               
â”‚ relation.n_name ASC â”‚                                                                                                                                                                                                               
â”‚ relation.s_name ASC â”‚                                                                                                                                                                                                               
â”‚ relation.ps_partkey â”‚                                                                                                                                                                                                               
â”‚          ASC        â”‚                                                                                                                                                                                                               
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                      
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                               
â”‚      PROJECTION     â”‚                                                                                                                                                                                                               
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                               
â”‚      s_acctbal      â”‚                                                                                                                                                                                                               
â”‚        s_name       â”‚                                                                                                                                                                                                               
â”‚        n_name       â”‚                                                                                                                                                                                                               
â”‚      ps_partkey     â”‚                                                                                                                                                                                                               
â”‚        p_mfgr       â”‚                                                                                                                                                                                                               
â”‚      s_address      â”‚                                                                                                                                                                                                               
â”‚       s_phone       â”‚                                                                                                                                                                                                               
â”‚      s_comment      â”‚                                                                                                                                                                                                               
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                      
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                               
â”‚      PROJECTION     â”‚                                                                                                                                                                                                               
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                               
â”‚      ps_partkey     â”‚                                                                                                                                                                                                               
â”‚        p_mfgr       â”‚                                                                                                                                                                                                               
â”‚        n_name       â”‚                                                                                                                                                                                                               
â”‚      s_acctbal      â”‚                                                                                                                                                                                                               
â”‚        s_name       â”‚                                                                                                                                                                                                               
â”‚      s_address      â”‚                                                                                                                                                                                                               
â”‚       s_phone       â”‚                                                                                                                                                                                                               
â”‚      s_comment      â”‚                                                                                                                                                                                                               
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                      
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                               
â”‚      HASH_JOIN      â”‚                                                                                                                                                                                                               
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                               
â”‚        INNER        â”‚                                                                                                                                                                                                               
â”‚    ps_supplycost    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                       
â”‚  =min_ps_supplycost â”‚                                                                                                       â”‚                                                                                                       
â”‚ps_partkey=ps_partkeyâ”‚                                                                                                       â”‚                                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                       â”‚                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            
â”‚      PROJECTION     â”‚                                                                                            â”‚    HASH_GROUP_BY    â”‚                                                                                            
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            
â”‚      ps_partkey     â”‚                                                                                            â”‚          #0         â”‚                                                                                            
â”‚    ps_supplycost    â”‚                                                                                            â”‚       min(#1)       â”‚                                                                                            
â”‚        p_mfgr       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚        n_name       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_acctbal      â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚        s_name       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_address      â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚       s_phone       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_comment      â”‚                                                                                            â”‚                     â”‚                                                                                            
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                   
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            
â”‚      PROJECTION     â”‚                                                                                            â”‚      PROJECTION     â”‚                                                                                            
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            
â”‚      ps_partkey     â”‚                                                                                            â”‚      ps_partkey     â”‚                                                                                            
â”‚    ps_supplycost    â”‚                                                                                            â”‚    ps_supplycost    â”‚                                                                                            
â”‚        p_mfgr       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_acctbal      â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚        s_name       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_address      â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚       s_phone       â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚      s_comment      â”‚                                                                                            â”‚                     â”‚                                                                                            
â”‚        n_name       â”‚                                                                                            â”‚                     â”‚                                                                                            
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                   
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            
â”‚      HASH_JOIN      â”‚                                                                                            â”‚      PROJECTION     â”‚                                                                                            
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            
â”‚        INNER        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚      ps_partkey     â”‚                                                                                            
â”‚     s_nationkey     â”‚                                                         â”‚                                  â”‚    ps_supplycost    â”‚                                                                                            
â”‚     =n_nationkey    â”‚                                                         â”‚                                  â”‚                     â”‚                                                                                            
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                   
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                            
â”‚      PROJECTION     â”‚                                              â”‚      PROJECTION     â”‚                       â”‚      HASH_JOIN      â”‚                                                                                            
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                            
â”‚      ps_partkey     â”‚                                              â”‚     n_nationkey     â”‚                       â”‚        INNER        â”‚                                                                                            
â”‚    ps_supplycost    â”‚                                              â”‚        n_name       â”‚                       â”‚     s_nationkey     â”‚                                                                                            
â”‚        p_mfgr       â”‚                                              â”‚                     â”‚                       â”‚     =n_nationkey    â”‚                                                                                            
â”‚     s_nationkey     â”‚                                              â”‚                     â”‚                       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  
â”‚      s_acctbal      â”‚                                              â”‚                     â”‚                       â”‚                     â”‚                                                         â”‚                                  
â”‚        s_name       â”‚                                              â”‚                     â”‚                       â”‚                     â”‚                                                         â”‚                                  
â”‚      s_address      â”‚                                              â”‚                     â”‚                       â”‚                     â”‚                                                         â”‚                                  
â”‚       s_phone       â”‚                                              â”‚                     â”‚                       â”‚                     â”‚                                                         â”‚                                  
â”‚      s_comment      â”‚                                              â”‚                     â”‚                       â”‚                     â”‚                                                         â”‚                                  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚                                                         
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       
â”‚      HASH_JOIN      â”‚                                              â”‚      HASH_JOIN      â”‚                       â”‚      PROJECTION     â”‚                                              â”‚      PROJECTION     â”‚                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       
â”‚        INNER        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚        INNER        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚      ps_partkey     â”‚                                              â”‚     n_nationkey     â”‚                       
â”‚ ps_suppkey=s_suppkeyâ”‚                                  â”‚           â”‚     n_regionkey     â”‚           â”‚           â”‚    ps_supplycost    â”‚                                              â”‚                     â”‚                       
â”‚                     â”‚                                  â”‚           â”‚     =r_regionkey    â”‚           â”‚           â”‚     s_nationkey     â”‚                                              â”‚                     â”‚                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       
â”‚      HASH_JOIN      â”‚                       â”‚      PROJECTION     â”‚â”‚   R_DATAFRAME_SCAN  â”‚â”‚      PROJECTION     â”‚â”‚      HASH_JOIN      â”‚                                              â”‚      HASH_JOIN      â”‚                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       
â”‚        INNER        â”‚                       â”‚      s_suppkey      â”‚â”‚      data.frame     â”‚â”‚          #0         â”‚â”‚        INNER        â”‚                                              â”‚        INNER        â”‚                       
â”‚ ps_partkey=p_partkeyâ”‚                       â”‚     s_nationkey     â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                     â”‚â”‚ ps_suppkey=s_suppkeyâ”‚                                              â”‚     n_regionkey     â”‚                       
â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚      s_acctbal      â”‚â”‚     n_nationkey     â”‚â”‚                     â”‚â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚     =r_regionkey    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           
â”‚                     â”‚           â”‚           â”‚        s_name       â”‚â”‚        n_name       â”‚â”‚                     â”‚â”‚                     â”‚                                  â”‚           â”‚                     â”‚           â”‚           
â”‚                     â”‚           â”‚           â”‚      s_address      â”‚â”‚     n_regionkey     â”‚â”‚                     â”‚â”‚                     â”‚                                  â”‚           â”‚                     â”‚           â”‚           
â”‚                     â”‚           â”‚           â”‚       s_phone       â”‚â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚                                  â”‚           â”‚                     â”‚           â”‚           
â”‚                     â”‚           â”‚           â”‚      s_comment      â”‚â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚                                  â”‚           â”‚                     â”‚           â”‚           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                                  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   R_DATAFRAME_SCAN  â”‚â”‚      PROJECTION     â”‚â”‚   R_DATAFRAME_SCAN  â”‚                       â”‚        FILTER       â”‚â”‚      PROJECTION     â”‚                       â”‚   R_DATAFRAME_SCAN  â”‚â”‚   R_DATAFRAME_SCAN  â”‚â”‚      PROJECTION     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚      data.frame     â”‚â”‚          #0         â”‚â”‚      data.frame     â”‚                       â”‚   r_name = EUROPE   â”‚â”‚      ps_partkey     â”‚                       â”‚      data.frame     â”‚â”‚      data.frame     â”‚â”‚          #0         â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚          #1         â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                       â”‚                     â”‚â”‚      ps_suppkey     â”‚                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                     â”‚
â”‚      ps_partkey     â”‚â”‚                     â”‚â”‚      s_suppkey      â”‚                       â”‚                     â”‚â”‚    ps_supplycost    â”‚                       â”‚      s_suppkey      â”‚â”‚     n_nationkey     â”‚â”‚                     â”‚
â”‚      ps_suppkey     â”‚â”‚                     â”‚â”‚        s_name       â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚     s_nationkey     â”‚â”‚     n_regionkey     â”‚â”‚                     â”‚
â”‚    ps_supplycost    â”‚â”‚                     â”‚â”‚      s_address      â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚
â”‚                     â”‚â”‚                     â”‚â”‚     s_nationkey     â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚
â”‚                     â”‚â”‚                     â”‚â”‚       s_phone       â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚
â”‚                     â”‚â”‚                     â”‚â”‚      s_acctbal      â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚
â”‚                     â”‚â”‚                     â”‚â”‚      s_comment      â”‚                       â”‚                     â”‚â”‚                     â”‚                       â”‚                     â”‚â”‚                     â”‚â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚        FILTER       â”‚                                              â”‚   R_DATAFRAME_SCAN  â”‚â”‚      HASH_JOIN      â”‚                                                                     â”‚        FILTER       â”‚
                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                       â”‚CAST(p_size AS DOUBLEâ”‚                                              â”‚      data.frame     â”‚â”‚        INNER        â”‚                                                                     â”‚   r_name = EUROPE   â”‚
                       â”‚  ) = 15.000000 AND  â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚ ps_partkey=p_partkeyâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                         â”‚                     â”‚
                       â”‚ suffix(CAST(p_t...  â”‚                                              â”‚     r_regionkey     â”‚â”‚                     â”‚           â”‚                                                         â”‚                     â”‚
                       â”‚  VARCHAR), 'BRASS') â”‚                                              â”‚        r_name       â”‚â”‚                     â”‚           â”‚                                                         â”‚                     â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   R_DATAFRAME_SCAN  â”‚                                                                     â”‚   R_DATAFRAME_SCAN  â”‚â”‚      PROJECTION     â”‚                                              â”‚   R_DATAFRAME_SCAN  â”‚
                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                       â”‚      data.frame     â”‚                                                                     â”‚      data.frame     â”‚â”‚          #0         â”‚                                              â”‚      data.frame     â”‚
                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                     â”‚                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                       â”‚      p_partkey      â”‚                                                                     â”‚      ps_partkey     â”‚â”‚                     â”‚                                              â”‚     r_regionkey     â”‚
                       â”‚        p_mfgr       â”‚                                                                     â”‚      ps_suppkey     â”‚â”‚                     â”‚                                              â”‚        r_name       â”‚
                       â”‚        p_type       â”‚                                                                     â”‚    ps_supplycost    â”‚â”‚                     â”‚                                              â”‚                     â”‚
                       â”‚        p_size       â”‚                                                                     â”‚                     â”‚â”‚                     â”‚                                              â”‚                     â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       
                                                                                                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                     
                                                                                                                                          â”‚        FILTER       â”‚                                                                     
                                                                                                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     
                                                                                                                                          â”‚CAST(p_size AS DOUBLEâ”‚                                                                     
                                                                                                                                          â”‚  ) = 15.000000 AND  â”‚                                                                     
                                                                                                                                          â”‚ suffix(CAST(p_t...  â”‚                                                                     
                                                                                                                                          â”‚  VARCHAR), 'BRASS') â”‚                                                                     
                                                                                                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                            
                                                                                                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                     
                                                                                                                                          â”‚   R_DATAFRAME_SCAN  â”‚                                                                     
                                                                                                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     
                                                                                                                                          â”‚      data.frame     â”‚                                                                     
                                                                                                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                     
                                                                                                                                          â”‚      p_partkey      â”‚                                                                     
                                                                                                                                          â”‚        p_type       â”‚                                                                     
                                                                                                                                          â”‚        p_size       â”‚                                                                     
                                                                                                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                            
NULL
[38;5;246m# A tibble: 100 Ã— 8[39m
   s_acctbal s_name  n_name  ps_partkey p_mfgr  s_address  s_phone s_comment    
       [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<int>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m      [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        
[38;5;250m 1[39m     -[31m986[39m[31m.[39m Suppliâ€¦ FRANCE      [4m1[24m[4m0[24m[4m3[24m626 Manufaâ€¦ [38;5;246m"[39mUT0ZxJ9vâ€¦ 16-568â€¦ [38;5;246m"[39mclosely bliâ€¦
[38;5;250m 2[39m     -[31m970[39m[31m.[39m Suppliâ€¦ UNITEDâ€¦     [4m1[24m[4m1[24m[4m7[24m143 Manufaâ€¦ [38;5;246m"[39m 0PDrXE2â€¦ 33-455â€¦ [38;5;246m"[39m foxes. furâ€¦
[38;5;250m 3[39m     -[31m964[39m[31m.[39m Suppliâ€¦ RUSSIA       [4m2[24m[4m0[24m064 Manufaâ€¦ [38;5;246m"[39mqzqDj7E8â€¦ 32-444â€¦ [38;5;246m"[39ml ideas wakâ€¦
[38;5;250m 4[39m     -[31m927[39m[31m.[39m Suppliâ€¦ UNITEDâ€¦     [4m1[24m[4m5[24m[4m0[24m998 Manufaâ€¦ [38;5;246m"[39mVXx4Mkb5â€¦ 33-482â€¦ [38;5;246m"[39my unusual aâ€¦
[38;5;250m 5[39m     -[31m906[39m[31m.[39m Suppliâ€¦ GERMANY      [4m7[24m[4m0[24m083 Manufaâ€¦ [38;5;246m"[39m0R4CnsF1â€¦ 17-497â€¦ [38;5;246m"[39mbold deposiâ€¦
[38;5;250m 6[39m     -[31m898[39m[31m.[39m Suppliâ€¦ UNITEDâ€¦      [4m9[24m[4m8[24m568 Manufaâ€¦ [38;5;246m"[39mKr6p2Rrvâ€¦ 33-984â€¦ [38;5;246m"[39mickly pendiâ€¦
[38;5;250m 7[39m     -[31m898[39m[31m.[39m Suppliâ€¦ UNITEDâ€¦     [4m1[24m[4m2[24m[4m1[24m074 Manufaâ€¦ [38;5;246m"[39mKr6p2Rrvâ€¦ 33-984â€¦ [38;5;246m"[39mickly pendiâ€¦
[38;5;250m 8[39m     -[31m898[39m[31m.[39m Suppliâ€¦ GERMANY     [4m1[24m[4m0[24m[4m2[24m158 Manufaâ€¦ [38;5;246m"[39moJ1v7ZKUâ€¦ 17-496â€¦ [38;5;246m"[39m along the â€¦
[38;5;250m 9[39m     -[31m898[39m[31m.[39m Suppliâ€¦ GERMANY     [4m1[24m[4m8[24m[4m4[24m604 Manufaâ€¦ [38;5;246m"[39moJ1v7ZKUâ€¦ 17-496â€¦ [38;5;246m"[39m along the â€¦
[38;5;250m10[39m     -[31m824[39m[31m.[39m Suppliâ€¦ RUSSIA      [4m1[24m[4m2[24m[4m5[24m868 Manufaâ€¦ [38;5;246m"[39m5uc7oPCMâ€¦ 32-328â€¦ [38;5;246m"[39mully pendinâ€¦
[38;5;246m# â€¦ with 90 more rows[39m
function () 
{
    oc <- select(inner_join(filter(select(orders, o_orderkey, 
        o_custkey, o_orderdate, o_shippriority), o_orderdate < 
        "1995-03-15"), filter(select(customer, c_custkey, c_mktsegment), 
        c_mktsegment == "BUILDING"), by = c(o_custkey = "c_custkey")), 
        o_orderkey, o_orderdate, o_shippriority)
    loc <- inner_join(select(filter(select(lineitem, l_orderkey, 
        l_shipdate, l_extendedprice, l_discount), l_shipdate > 
        "1995-03-15"), l_orderkey, l_extendedprice, l_discount), 
        oc, by = c(l_orderkey = "o_orderkey"))
    aggr <- head(arrange(select(summarise(group_by(mutate(loc, 
        volume = l_extendedprice * (1 - l_discount)), l_orderkey, 
        o_orderdate, o_shippriority), revenue = sum(volume)), 
        l_orderkey, revenue, o_orderdate, o_shippriority), revenue, 
        o_orderdate), 10)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚           TOP_N           â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚           Top 10          â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚    relation.revenue ASC   â”‚                                                          
â”‚  relation.o_orderdate ASC â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_orderkey        â”‚                                                          
â”‚          revenue          â”‚                                                          
â”‚        o_orderdate        â”‚                                                          
â”‚       o_shippriority      â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚       HASH_GROUP_BY       â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚             #0            â”‚                                                          
â”‚             #1            â”‚                                                          
â”‚             #2            â”‚                                                          
â”‚          sum(#3)          â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_orderkey        â”‚                                                          
â”‚        o_orderdate        â”‚                                                          
â”‚       o_shippriority      â”‚                                                          
â”‚           volume          â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_orderkey        â”‚                                                          
â”‚        o_orderdate        â”‚                                                          
â”‚       o_shippriority      â”‚                                                          
â”‚           volume          â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         HASH_JOIN         â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           
â”‚   l_orderkey=o_orderkey   â”‚              â”‚                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚             #0            â”‚â”‚         o_orderkey        â”‚                             
â”‚             #1            â”‚â”‚        o_orderdate        â”‚                             
â”‚             #2            â”‚â”‚       o_shippriority      â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚           FILTER          â”‚â”‚         HASH_JOIN         â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚ l_shipdate > '1995-03-15':â”‚â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚           :DATE           â”‚â”‚    o_custkey=c_custkey    â”‚              â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      R_DATAFRAME_SCAN     â”‚â”‚           FILTER          â”‚â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         data.frame        â”‚â”‚o_orderdate < '1995-03-15':â”‚â”‚             #0            â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚           :DATE           â”‚â”‚                           â”‚
â”‚         l_orderkey        â”‚â”‚                           â”‚â”‚                           â”‚
â”‚      l_extendedprice      â”‚â”‚                           â”‚â”‚                           â”‚
â”‚         l_discount        â”‚â”‚                           â”‚â”‚                           â”‚
â”‚         l_shipdate        â”‚â”‚                           â”‚â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚      R_DATAFRAME_SCAN     â”‚â”‚           FILTER          â”‚
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                             â”‚         data.frame        â”‚â”‚  c_mktsegment = BUILDING  â”‚
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                           â”‚
                             â”‚         o_orderkey        â”‚â”‚                           â”‚
                             â”‚         o_custkey         â”‚â”‚                           â”‚
                             â”‚        o_orderdate        â”‚â”‚                           â”‚
                             â”‚       o_shippriority      â”‚â”‚                           â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                          â”‚      R_DATAFRAME_SCAN     â”‚
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                                                          â”‚         data.frame        â”‚
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
                                                          â”‚         c_custkey         â”‚
                                                          â”‚        c_mktsegment       â”‚
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
NULL
[38;5;246m# A tibble: 10 Ã— 4[39m
   l_orderkey revenue o_orderdate o_shippriority
        [3m[38;5;246m<int>[39m[23m   [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<date>[39m[23m               [3m[38;5;246m<int>[39m[23m
[38;5;250m 1[39m    3[4m2[24m[4m8[24m[4m3[24m971    851. 1994-12-27               0
[38;5;250m 2[39m     [4m6[24m[4m1[24m[4m7[24m767    902. 1995-02-17               0
[38;5;250m 3[39m    4[4m8[24m[4m1[24m[4m0[24m887    947. 1994-12-31               0
[38;5;250m 4[39m    4[4m2[24m[4m7[24m[4m6[24m512    961. 1994-12-31               0
[38;5;250m 5[39m    4[4m0[24m[4m9[24m[4m6[24m903    967. 1995-01-31               0
[38;5;250m 6[39m    2[4m6[24m[4m7[24m[4m4[24m948   [4m1[24m009. 1995-02-05               0
[38;5;250m 7[39m    1[4m7[24m[4m9[24m[4m6[24m705   [4m1[24m019. 1995-01-03               0
[38;5;250m 8[39m    1[4m0[24m[4m3[24m[4m3[24m956   [4m1[24m061. 1994-12-23               0
[38;5;250m 9[39m    5[4m9[24m[4m9[24m[4m6[24m519   [4m1[24m069. 1994-12-06               0
[38;5;250m10[39m    1[4m0[24m[4m2[24m[4m3[24m046   [4m1[24m073. 1994-12-25               0
function () 
{
    l <- select(filter(select(lineitem, l_orderkey, l_commitdate, 
        l_receiptdate), l_commitdate < l_receiptdate), l_orderkey)
    o <- select(filter(select(orders, o_orderkey, o_orderdate, 
        o_orderpriority), o_orderdate >= "1993-07-01", o_orderdate < 
        "1993-10-01"), o_orderkey, o_orderpriority)
    lo <- select(distinct(inner_join(l, o, by = c(l_orderkey = "o_orderkey"))), 
        o_orderpriority)
    aggr <- arrange(summarise(group_by(lo, o_orderpriority), 
        order_count = n()), o_orderpriority)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚          ORDER_BY         â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚  relation.o_orderpriority â”‚                             
â”‚             ASC           â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚       HASH_GROUP_BY       â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚             #0            â”‚                             
â”‚        count_star()       â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚      o_orderpriority      â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚      o_orderpriority      â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚       HASH_GROUP_BY       â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚             #0            â”‚                             
â”‚             #1            â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚   inner_join_lhs_5384972  â”‚                             
â”‚        .l_orderkey        â”‚                             
â”‚   inner_join_rhs_7104270  â”‚                             
â”‚      .o_orderpriority     â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         HASH_JOIN         â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚   l_orderkey=o_orderkey   â”‚              â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚             #0            â”‚â”‚             #0            â”‚
â”‚                           â”‚â”‚             #2            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FILTER          â”‚â”‚           FILTER          â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚       l_commitdate <      â”‚â”‚ o_orderdate BETWEEN '1993 â”‚
â”‚        l_receiptdate      â”‚â”‚-07-01'::DATE AND '199...  â”‚
â”‚                           â”‚â”‚          '::DATE          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      R_DATAFRAME_SCAN     â”‚â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         data.frame        â”‚â”‚         data.frame        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_orderkey        â”‚â”‚         o_orderkey        â”‚
â”‚        l_commitdate       â”‚â”‚        o_orderdate        â”‚
â”‚       l_receiptdate       â”‚â”‚      o_orderpriority      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
NULL
[38;5;246m# A tibble: 5 Ã— 2[39m
  o_orderpriority order_count
  [3m[38;5;246m<chr>[39m[23m                 [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m 5-LOW                 [4m1[24m[4m0[24m487
[38;5;250m2[39m 2-HIGH                [4m1[24m[4m0[24m476
[38;5;250m3[39m 3-MEDIUM              [4m1[24m[4m0[24m410
[38;5;250m4[39m 4-NOT SPECIFIED       [4m1[24m[4m0[24m556
[38;5;250m5[39m 1-URGENT              [4m1[24m[4m0[24m594
function () 
{
    nr <- select(inner_join(select(nation, n_nationkey, n_regionkey, 
        n_name), filter(select(region, r_regionkey, r_name), 
        r_name == "ASIA"), by = c(n_regionkey = "r_regionkey")), 
        n_nationkey, n_name)
    snr <- select(inner_join(select(supplier, s_suppkey, s_nationkey), 
        nr, by = c(s_nationkey = "n_nationkey")), s_suppkey, 
        s_nationkey, n_name)
    lsnr <- inner_join(select(lineitem, l_suppkey, l_orderkey, 
        l_extendedprice, l_discount), snr, by = c(l_suppkey = "s_suppkey"))
    o <- select(filter(select(orders, o_orderdate, o_orderkey, 
        o_custkey), o_orderdate >= "1994-01-01", o_orderdate < 
        "1995-01-01"), o_orderkey, o_custkey)
    oc <- select(inner_join(o, select(customer, c_custkey, c_nationkey), 
        by = c(o_custkey = "c_custkey")), o_orderkey, c_nationkey)
    lsnroc <- select(inner_join(lsnr, oc, by = c(l_orderkey = "o_orderkey", 
        s_nationkey = "c_nationkey")), l_extendedprice, l_discount, 
        n_name)
    aggr <- arrange(summarise(group_by(mutate(lsnroc, volume = l_extendedprice * 
        (1 - l_discount)), n_name), revenue = sum(volume)), revenue)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚          ORDER_BY         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚  sum(relation.volume) ASC â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚       HASH_GROUP_BY       â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚             #0            â”‚                                                                                                                                                 
â”‚          sum(#1)          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           n_name          â”‚                                                                                                                                                 
â”‚           volume          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           n_name          â”‚                                                                                                                                                 
â”‚           volume          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚      l_extendedprice      â”‚                                                                                                                                                 
â”‚         l_discount        â”‚                                                                                                                                                 
â”‚           n_name          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         HASH_JOIN         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           
â”‚   l_orderkey=o_orderkey   â”‚                                                                                                     â”‚                                           
â”‚  s_nationkey=c_nationkey  â”‚                                                                                                     â”‚                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                     â”‚                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                                                                                       â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         l_orderkey        â”‚                                                                                       â”‚         o_orderkey        â”‚                             
â”‚      l_extendedprice      â”‚                                                                                       â”‚        c_nationkey        â”‚                             
â”‚         l_discount        â”‚                                                                                       â”‚                           â”‚                             
â”‚        s_nationkey        â”‚                                                                                       â”‚                           â”‚                             
â”‚           n_name          â”‚                                                                                       â”‚                           â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         HASH_JOIN         â”‚                                                                                       â”‚         HASH_JOIN         â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚    l_suppkey=s_suppkey    â”‚              â”‚                                                                        â”‚    o_custkey=c_custkey    â”‚              â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚â”‚         HASH_JOIN         â”‚                                                          â”‚         PROJECTION        â”‚â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_suppkey         â”‚â”‚           INNER           â”‚                                                          â”‚             #0            â”‚â”‚         data.frame        â”‚
â”‚         l_orderkey        â”‚â”‚  s_nationkey=n_nationkey  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚             #1            â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚      l_extendedprice      â”‚â”‚                           â”‚              â”‚                                           â”‚                           â”‚â”‚         c_custkey         â”‚
â”‚         l_discount        â”‚â”‚                           â”‚              â”‚                                           â”‚                           â”‚â”‚        c_nationkey        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚      R_DATAFRAME_SCAN     â”‚â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚                             â”‚           FILTER          â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         data.frame        â”‚â”‚         data.frame        â”‚â”‚        n_nationkey        â”‚                             â”‚ o_orderdate BETWEEN '1994 â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚           n_name          â”‚                             â”‚-01-01'::DATE AND '199...  â”‚                             
â”‚         l_orderkey        â”‚â”‚         s_suppkey         â”‚â”‚                           â”‚                             â”‚          '::DATE          â”‚                             
â”‚         l_suppkey         â”‚â”‚        s_nationkey        â”‚â”‚                           â”‚                             â”‚                           â”‚                             
â”‚      l_extendedprice      â”‚â”‚                           â”‚â”‚                           â”‚                             â”‚                           â”‚                             
â”‚         l_discount        â”‚â”‚                           â”‚â”‚                           â”‚                             â”‚                           â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
                                                          â”‚         HASH_JOIN         â”‚                             â”‚      R_DATAFRAME_SCAN     â”‚                             
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
                                                          â”‚           INNER           â”‚                             â”‚         data.frame        â”‚                             
                                                          â”‚  n_regionkey=r_regionkey  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
                                                          â”‚                           â”‚              â”‚              â”‚         o_orderkey        â”‚                             
                                                          â”‚                           â”‚              â”‚              â”‚         o_custkey         â”‚                             
                                                          â”‚                           â”‚              â”‚              â”‚        o_orderdate        â”‚                             
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                                                          â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚                                                          
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                          â”‚        n_nationkey        â”‚â”‚             #0            â”‚                                                          
                                                          â”‚        n_regionkey        â”‚â”‚                           â”‚                                                          
                                                          â”‚           n_name          â”‚â”‚                           â”‚                                                          
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                                                          â”‚      R_DATAFRAME_SCAN     â”‚â”‚           FILTER          â”‚                                                          
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                          â”‚         data.frame        â”‚â”‚       r_name = ASIA       â”‚                                                          
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                           â”‚                                                          
                                                          â”‚        n_nationkey        â”‚â”‚                           â”‚                                                          
                                                          â”‚           n_name          â”‚â”‚                           â”‚                                                          
                                                          â”‚        n_regionkey        â”‚â”‚                           â”‚                                                          
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                                                                                       â”‚      R_DATAFRAME_SCAN     â”‚                                                          
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                                                       â”‚         data.frame        â”‚                                                          
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                                                       â”‚        r_regionkey        â”‚                                                          
                                                                                       â”‚           r_name          â”‚                                                          
                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
NULL
[38;5;246m# A tibble: 5 Ã— 2[39m
  n_name      revenue
  [3m[38;5;246m<chr>[39m[23m         [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m JAPAN     45[4m4[24m[4m1[24m[4m0[24m176.
[38;5;250m2[39m INDIA     52[4m0[24m[4m3[24m[4m5[24m512.
[38;5;250m3[39m CHINA     53[4m7[24m[4m2[24m[4m4[24m494.
[38;5;250m4[39m VIETNAM   55[4m2[24m[4m9[24m[4m5[24m087.
[38;5;250m5[39m INDONESIA 55[4m5[24m[4m0[24m[4m2[24m041.
function () 
{
    summarise(select(filter(select(lineitem, l_shipdate, l_extendedprice, 
        l_discount, l_quantity), l_shipdate >= "1994-01-01", 
        l_shipdate < "1995-01-01", l_discount >= 0.05, l_discount <= 
            0.07, l_quantity < 24), l_extendedprice, l_discount), 
        revenue = sum(l_extendedprice * l_discount))
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SIMPLE_AGGREGATE     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚          sum(#0)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚     *(l_extendedprice,    â”‚
â”‚         l_discount)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚             #1            â”‚
â”‚             #2            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FILTER          â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚l_shipdate BETWEEN '1994-01â”‚
â”‚-01'::DATE AND '1995-01-01'â”‚
â”‚ ::DATE AND CAST(l_quantityâ”‚
â”‚ AS DOUBLE) < 24.000000 ANDâ”‚
â”‚ l_discount BETWEEN 0....  â”‚
â”‚        AND 0.070000       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         data.frame        â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_quantity        â”‚
â”‚      l_extendedprice      â”‚
â”‚         l_discount        â”‚
â”‚         l_shipdate        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
NULL
[38;5;246m# A tibble: 1 Ã— 1[39m
     revenue
       [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m 123[4m1[24m[4m4[24m[4m1[24m078.
function () 
{
    sn <- select(inner_join(select(supplier, s_nationkey, s_suppkey), 
        filter(select(nation, n1_nationkey = n_nationkey, n1_name = n_name), 
            n1_name == "FRANCE" || n1_name == "GERMANY"), by = c(s_nationkey = "n1_nationkey")), 
        s_suppkey, n1_name)
    cn <- select(inner_join(select(customer, c_custkey, c_nationkey), 
        filter(select(nation, n2_nationkey = n_nationkey, n2_name = n_name), 
            n2_name == "FRANCE" || n2_name == "GERMANY"), by = c(c_nationkey = "n2_nationkey")), 
        c_custkey, n2_name)
    cno <- select(inner_join(select(orders, o_custkey, o_orderkey), 
        cn, by = c(o_custkey = "c_custkey")), o_orderkey, n2_name)
    cnol <- select(inner_join(filter(select(lineitem, l_orderkey, 
        l_suppkey, l_shipdate, l_extendedprice, l_discount), 
        l_shipdate >= "1995-01-01", l_shipdate <= "1996-12-31"), 
        cno, by = c(l_orderkey = "o_orderkey")), l_suppkey, l_shipdate, 
        l_extendedprice, l_discount, n2_name)
    all <- inner_join(cnol, sn, by = c(l_suppkey = "s_suppkey"))
    aggr <- arrange(summarise(group_by(select(mutate(filter(all, 
        (n1_name == "FRANCE" & n2_name == "GERMANY") | (n1_name == 
            "GERMANY" & n2_name == "FRANCE")), supp_nation = n1_name, 
        cust_nation = n2_name, l_year = as.integer(strftime(l_shipdate, 
            "%Y")), volume = l_extendedprice * (1 - l_discount)), 
        supp_nation, cust_nation, l_year, volume), supp_nation, 
        cust_nation, l_year), revenue = sum(volume)), supp_nation, 
        cust_nation, l_year)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚          ORDER_BY         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚  relation.supp_nation ASC â”‚                                                                                                                                                 
â”‚  relation.cust_nation ASC â”‚                                                                                                                                                 
â”‚    relation.l_year ASC    â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚       HASH_GROUP_BY       â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚             #0            â”‚                                                                                                                                                 
â”‚             #1            â”‚                                                                                                                                                 
â”‚             #2            â”‚                                                                                                                                                 
â”‚          sum(#3)          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚        supp_nation        â”‚                                                                                                                                                 
â”‚        cust_nation        â”‚                                                                                                                                                 
â”‚           l_year          â”‚                                                                                                                                                 
â”‚           volume          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚        supp_nation        â”‚                                                                                                                                                 
â”‚        cust_nation        â”‚                                                                                                                                                 
â”‚           l_year          â”‚                                                                                                                                                 
â”‚           volume          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚             #1            â”‚                                                                                                                                                 
â”‚             #2            â”‚                                                                                                                                                 
â”‚             #3            â”‚                                                                                                                                                 
â”‚             #4            â”‚                                                                                                                                                 
â”‚             #5            â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚           FILTER          â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚    n1_name = FRANCE AND   â”‚                                                                                                                                                 
â”‚ n2_name = GERMANY OR ...  â”‚                                                                                                                                                 
â”‚ GERMANY AND n2_name =...  â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         HASH_JOIN         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           
â”‚    l_suppkey=s_suppkey    â”‚                                                                                                     â”‚                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                     â”‚                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                                                                                       â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         l_suppkey         â”‚                                                                                       â”‚         s_suppkey         â”‚                             
â”‚         l_shipdate        â”‚                                                                                       â”‚          n1_name          â”‚                             
â”‚      l_extendedprice      â”‚                                                                                       â”‚                           â”‚                             
â”‚         l_discount        â”‚                                                                                       â”‚                           â”‚                             
â”‚          n2_name          â”‚                                                                                       â”‚                           â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         HASH_JOIN         â”‚                                                                                       â”‚         HASH_JOIN         â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚   l_orderkey=o_orderkey   â”‚              â”‚                                                                        â”‚  s_nationkey=n1_nationkey â”‚              â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚                                                          â”‚         PROJECTION        â”‚â”‚           FILTER          â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_orderkey        â”‚â”‚         o_orderkey        â”‚                                                          â”‚        s_nationkey        â”‚â”‚n_name = FRANCE OR n_name =â”‚
â”‚         l_suppkey         â”‚â”‚          n2_name          â”‚                                                          â”‚         s_suppkey         â”‚â”‚           GERMANY         â”‚
â”‚         l_shipdate        â”‚â”‚                           â”‚                                                          â”‚                           â”‚â”‚                           â”‚
â”‚      l_extendedprice      â”‚â”‚                           â”‚                                                          â”‚                           â”‚â”‚                           â”‚
â”‚         l_discount        â”‚â”‚                           â”‚                                                          â”‚                           â”‚â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FILTER          â”‚â”‚         HASH_JOIN         â”‚                                                          â”‚      R_DATAFRAME_SCAN     â”‚â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚l_shipdate BETWEEN '1995-01â”‚â”‚           INNER           â”‚                                                          â”‚         data.frame        â”‚â”‚         data.frame        â”‚
â”‚-01'::DATE AND '1996-12-31'â”‚â”‚    o_custkey=c_custkey    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚           ::DATE          â”‚â”‚                           â”‚              â”‚                                           â”‚         s_suppkey         â”‚â”‚        n_nationkey        â”‚
â”‚                           â”‚â”‚                           â”‚              â”‚                                           â”‚        s_nationkey        â”‚â”‚           n_name          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚         data.frame        â”‚â”‚         o_custkey         â”‚â”‚         c_custkey         â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚         o_orderkey        â”‚â”‚          n2_name          â”‚                                                                                       
â”‚         l_orderkey        â”‚â”‚                           â”‚â”‚                           â”‚                                                                                       
â”‚         l_suppkey         â”‚â”‚                           â”‚â”‚                           â”‚                                                                                       
â”‚      l_extendedprice      â”‚â”‚                           â”‚â”‚                           â”‚                                                                                       
â”‚         l_discount        â”‚â”‚                           â”‚â”‚                           â”‚                                                                                       
â”‚         l_shipdate        â”‚â”‚                           â”‚â”‚                           â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                             â”‚      R_DATAFRAME_SCAN     â”‚â”‚         HASH_JOIN         â”‚                                                                                       
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                             â”‚         data.frame        â”‚â”‚           INNER           â”‚                                                                                       
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚  c_nationkey=n2_nationkey â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        
                             â”‚         o_orderkey        â”‚â”‚                           â”‚              â”‚                                                                        
                             â”‚         o_custkey         â”‚â”‚                           â”‚              â”‚                                                                        
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                     
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                                                          â”‚      R_DATAFRAME_SCAN     â”‚â”‚           FILTER          â”‚                                                          
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                          â”‚         data.frame        â”‚â”‚n_name = FRANCE OR n_name =â”‚                                                          
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚           GERMANY         â”‚                                                          
                                                          â”‚         c_custkey         â”‚â”‚                           â”‚                                                          
                                                          â”‚        c_nationkey        â”‚â”‚                           â”‚                                                          
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                                                                                       â”‚      R_DATAFRAME_SCAN     â”‚                                                          
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                                                       â”‚         data.frame        â”‚                                                          
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                                                                                       â”‚        n_nationkey        â”‚                                                          
                                                                                       â”‚           n_name          â”‚                                                          
                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
NULL
[38;5;246m# A tibble: 4 Ã— 4[39m
  supp_nation cust_nation l_year   revenue
  [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<int>[39m[23m     [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m FRANCE      GERMANY       [4m1[24m995 54[4m6[24m[4m3[24m[4m9[24m733.
[38;5;250m2[39m FRANCE      GERMANY       [4m1[24m996 54[4m6[24m[4m3[24m[4m3[24m083.
[38;5;250m3[39m GERMANY     FRANCE        [4m1[24m995 52[4m5[24m[4m3[24m[4m1[24m747.
[38;5;250m4[39m GERMANY     FRANCE        [4m1[24m996 52[4m5[24m[4m2[24m[4m0[24m549.
function () 
{
    nr <- select(inner_join(select(nation, n1_nationkey = n_nationkey, 
        n1_regionkey = n_regionkey), select(filter(select(region, 
        r_regionkey, r_name), r_name == "AMERICA"), r_regionkey), 
        by = c(n1_regionkey = "r_regionkey")), n1_nationkey)
    cnr <- select(inner_join(select(customer, c_custkey, c_nationkey), 
        nr, by = c(c_nationkey = "n1_nationkey")), c_custkey)
    ocnr <- select(inner_join(filter(select(orders, o_orderkey, 
        o_custkey, o_orderdate), o_orderdate >= "1995-01-01", 
        o_orderdate <= "1996-12-31"), cnr, by = c(o_custkey = "c_custkey")), 
        o_orderkey, o_orderdate)
    locnr <- select(inner_join(select(lineitem, l_orderkey, l_partkey, 
        l_suppkey, l_extendedprice, l_discount), ocnr, by = c(l_orderkey = "o_orderkey")), 
        l_partkey, l_suppkey, l_extendedprice, l_discount, o_orderdate)
    locnrp <- select(inner_join(locnr, select(filter(select(part, 
        p_partkey, p_type), p_type == "ECONOMY ANODIZED STEEL"), 
        p_partkey), by = c(l_partkey = "p_partkey")), l_suppkey, 
        l_extendedprice, l_discount, o_orderdate)
    locnrps <- select(inner_join(locnrp, select(supplier, s_suppkey, 
        s_nationkey), by = c(l_suppkey = "s_suppkey")), l_extendedprice, 
        l_discount, o_orderdate, s_nationkey)
    all <- select(inner_join(locnrps, select(nation, n2_nationkey = n_nationkey, 
        n2_name = n_name), by = c(s_nationkey = "n2_nationkey")), 
        l_extendedprice, l_discount, o_orderdate, n2_name)
    aggr <- arrange(summarise(group_by(select(mutate(all, o_year = as.integer(strftime(o_orderdate, 
        "%Y")), volume = l_extendedprice * (1 - l_discount), 
        nation = n2_name), o_year, volume, nation), o_year), 
        mkt_share = sum(ifelse(nation == "BRAZIL", volume, 0))/sum(volume)), 
        o_year)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚          ORDER_BY         â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚    relation.o_year ASC    â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         PROJECTION        â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           o_year          â”‚                                                                                                                                                                                                           
â”‚         mkt_share         â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚       HASH_GROUP_BY       â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚             #0            â”‚                                                                                                                                                                                                           
â”‚          sum(#1)          â”‚                                                                                                                                                                                                           
â”‚          sum(#2)          â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         PROJECTION        â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           o_year          â”‚                                                                                                                                                                                                           
â”‚CASE  WHEN (nation = BRAZILâ”‚                                                                                                                                                                                                           
â”‚   ) THEN (volume) ELSE 0  â”‚                                                                                                                                                                                                           
â”‚        .000000 END        â”‚                                                                                                                                                                                                           
â”‚           volume          â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         PROJECTION        â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           o_year          â”‚                                                                                                                                                                                                           
â”‚           volume          â”‚                                                                                                                                                                                                           
â”‚           nation          â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         PROJECTION        â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚      l_extendedprice      â”‚                                                                                                                                                                                                           
â”‚         l_discount        â”‚                                                                                                                                                                                                           
â”‚        o_orderdate        â”‚                                                                                                                                                                                                           
â”‚          n2_name          â”‚                                                                                                                                                                                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         HASH_JOIN         â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚  s_nationkey=n2_nationkey â”‚                                                                                                                                                                                            â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                                            â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚                                                                                                                                                                              â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚      l_extendedprice      â”‚                                                                                                                                                                              â”‚         data.frame        â”‚
â”‚         l_discount        â”‚                                                                                                                                                                              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚        o_orderdate        â”‚                                                                                                                                                                              â”‚        n_nationkey        â”‚
â”‚        s_nationkey        â”‚                                                                                                                                                                              â”‚           n_name          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         HASH_JOIN         â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           
â”‚    l_suppkey=s_suppkey    â”‚                                                                                                                                                               â”‚                                           
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                               â”‚                                                                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                                                                                                                                                 â”‚      R_DATAFRAME_SCAN     â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         l_suppkey         â”‚                                                                                                                                                 â”‚         data.frame        â”‚                             
â”‚      l_extendedprice      â”‚                                                                                                                                                 â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         l_discount        â”‚                                                                                                                                                 â”‚         s_suppkey         â”‚                             
â”‚        o_orderdate        â”‚                                                                                                                                                 â”‚        s_nationkey        â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                                                           
â”‚         HASH_JOIN         â”‚                                                                                                                                                                                                           
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                                                           
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        
â”‚    l_partkey=p_partkey    â”‚                                                                                                                                  â”‚                                                                        
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                  â”‚                                                                                                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         PROJECTION        â”‚                                                                                                                    â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_partkey         â”‚                                                                                                                    â”‚             #0            â”‚                                                          
â”‚         l_suppkey         â”‚                                                                                                                    â”‚                           â”‚                                                          
â”‚      l_extendedprice      â”‚                                                                                                                    â”‚                           â”‚                                                          
â”‚         l_discount        â”‚                                                                                                                    â”‚                           â”‚                                                          
â”‚        o_orderdate        â”‚                                                                                                                    â”‚                           â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         HASH_JOIN         â”‚                                                                                                                    â”‚           FILTER          â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                     â”‚ p_type = ECONOMY ANODIZED â”‚                                                          
â”‚   l_orderkey=o_orderkey   â”‚              â”‚                                                                                                     â”‚            STEEL          â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚                                                                                       â”‚      R_DATAFRAME_SCAN     â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         data.frame        â”‚â”‚         o_orderkey        â”‚                                                                                       â”‚         data.frame        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚        o_orderdate        â”‚                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_orderkey        â”‚â”‚                           â”‚                                                                                       â”‚         p_partkey         â”‚                                                          
â”‚         l_partkey         â”‚â”‚                           â”‚                                                                                       â”‚           p_type          â”‚                                                          
â”‚         l_suppkey         â”‚â”‚                           â”‚                                                                                       â”‚                           â”‚                                                          
â”‚      l_extendedprice      â”‚â”‚                           â”‚                                                                                       â”‚                           â”‚                                                          
â”‚         l_discount        â”‚â”‚                           â”‚                                                                                       â”‚                           â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                                              
                             â”‚         HASH_JOIN         â”‚                                                                                                                                                                              
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                                              
                             â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                               
                             â”‚    o_custkey=c_custkey    â”‚              â”‚                                                                                                                                                               
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                                                                                                            
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
                             â”‚           FILTER          â”‚â”‚         PROJECTION        â”‚                                                                                                                                                 
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
                             â”‚ o_orderdate BETWEEN '1995 â”‚â”‚         c_custkey         â”‚                                                                                                                                                 
                             â”‚-01-01'::DATE AND '199...  â”‚â”‚                           â”‚                                                                                                                                                 
                             â”‚          '::DATE          â”‚â”‚                           â”‚                                                                                                                                                 
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
                             â”‚      R_DATAFRAME_SCAN     â”‚â”‚         HASH_JOIN         â”‚                                                                                                                                                 
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
                             â”‚         data.frame        â”‚â”‚           INNER           â”‚                                                                                                                                                 
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚  c_nationkey=n1_nationkey â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                  
                             â”‚         o_orderkey        â”‚â”‚                           â”‚              â”‚                                                                                                                                  
                             â”‚         o_custkey         â”‚â”‚                           â”‚              â”‚                                                                                                                                  
                             â”‚        o_orderdate        â”‚â”‚                           â”‚              â”‚                                                                                                                                  
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                                                                               
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    
                                                          â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚                                                                                                                    
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    
                                                          â”‚         data.frame        â”‚â”‚        n1_nationkey       â”‚                                                                                                                    
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                           â”‚                                                                                                                    
                                                          â”‚         c_custkey         â”‚â”‚                           â”‚                                                                                                                    
                                                          â”‚        c_nationkey        â”‚â”‚                           â”‚                                                                                                                    
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                 
                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    
                                                                                       â”‚         HASH_JOIN         â”‚                                                                                                                    
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    
                                                                                       â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                     
                                                                                       â”‚  n1_regionkey=r_regionkey â”‚              â”‚                                                                                                     
                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                                                  
                                                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                                                                                       â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚                                                                                       
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                                                       â”‚         data.frame        â”‚â”‚             #0            â”‚                                                                                       
                                                                                       â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚                           â”‚                                                                                       
                                                                                       â”‚        n_nationkey        â”‚â”‚                           â”‚                                                                                       
                                                                                       â”‚        n_regionkey        â”‚â”‚                           â”‚                                                                                       
                                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
                                                                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                                                                                                                    â”‚           FILTER          â”‚                                                                                       
                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                                                                                    â”‚      r_name = AMERICA     â”‚                                                                                       
                                                                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
                                                                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                                                                                                                    â”‚      R_DATAFRAME_SCAN     â”‚                                                                                       
                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                                                                                    â”‚         data.frame        â”‚                                                                                       
                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                                                                                    â”‚        r_regionkey        â”‚                                                                                       
                                                                                                                    â”‚           r_name          â”‚                                                                                       
                                                                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
NULL
[38;5;246m# A tibble: 2 Ã— 2[39m
  o_year mkt_share
   [3m[38;5;246m<int>[39m[23m     [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m   [4m1[24m995    0.034[4m4[24m
[38;5;250m2[39m   [4m1[24m996    0.041[4m5[24m
function () 
{
    p <- select(filter(select(part, p_name, p_partkey), grepl(".*green.*", 
        p_name)), p_partkey)
    psp <- inner_join(select(partsupp, ps_suppkey, ps_partkey, 
        ps_supplycost), p, by = c(ps_partkey = "p_partkey"))
    sn <- select(inner_join(select(supplier, s_suppkey, s_nationkey), 
        select(nation, n_nationkey, n_name), by = c(s_nationkey = "n_nationkey")), 
        s_suppkey, n_name)
    pspsn <- inner_join(psp, sn, by = c(ps_suppkey = "s_suppkey"))
    lpspsn <- select(inner_join(select(lineitem, l_suppkey, l_partkey, 
        l_orderkey, l_extendedprice, l_discount, l_quantity), 
        pspsn, by = c(l_suppkey = "ps_suppkey", l_partkey = "ps_partkey")), 
        l_orderkey, l_extendedprice, l_discount, l_quantity, 
        ps_supplycost, n_name)
    all <- select(inner_join(select(orders, o_orderkey, o_orderdate), 
        lpspsn, by = c(o_orderkey = "l_orderkey")), l_extendedprice, 
        l_discount, l_quantity, ps_supplycost, n_name, o_orderdate)
    aggr <- arrange(summarise(group_by(select(mutate(all, nation = n_name, 
        o_year = as.integer(strftime(o_orderdate, "%Y")), amount = l_extendedprice * 
            (1 - l_discount) - ps_supplycost * l_quantity), nation, 
        o_year, amount), nation, o_year), sum_profit = sum(amount)), 
        nation, o_year)
    aggr
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚          ORDER_BY         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚    relation.nation ASC    â”‚                                                                                                                                                 
â”‚    relation.o_year ASC    â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚       HASH_GROUP_BY       â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚             #0            â”‚                                                                                                                                                 
â”‚             #1            â”‚                                                                                                                                                 
â”‚          sum(#2)          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           nation          â”‚                                                                                                                                                 
â”‚           o_year          â”‚                                                                                                                                                 
â”‚           amount          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           nation          â”‚                                                                                                                                                 
â”‚           o_year          â”‚                                                                                                                                                 
â”‚           amount          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚      l_extendedprice      â”‚                                                                                                                                                 
â”‚         l_discount        â”‚                                                                                                                                                 
â”‚         l_quantity        â”‚                                                                                                                                                 
â”‚       ps_supplycost       â”‚                                                                                                                                                 
â”‚           n_name          â”‚                                                                                                                                                 
â”‚        o_orderdate        â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         PROJECTION        â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚        o_orderdate        â”‚                                                                                                                                                 
â”‚      l_extendedprice      â”‚                                                                                                                                                 
â”‚         l_discount        â”‚                                                                                                                                                 
â”‚         l_quantity        â”‚                                                                                                                                                 
â”‚       ps_supplycost       â”‚                                                                                                                                                 
â”‚           n_name          â”‚                                                                                                                                                 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                                                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         HASH_JOIN         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚   l_orderkey=o_orderkey   â”‚                                                                                                                                  â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                                  â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROJECTION        â”‚                                                                                                                    â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_orderkey        â”‚                                                                                                                    â”‚         data.frame        â”‚
â”‚      l_extendedprice      â”‚                                                                                                                    â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚         l_discount        â”‚                                                                                                                    â”‚         o_orderkey        â”‚
â”‚         l_quantity        â”‚                                                                                                                    â”‚        o_orderdate        â”‚
â”‚       ps_supplycost       â”‚                                                                                                                    â”‚                           â”‚
â”‚           n_name          â”‚                                                                                                                    â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                                 
â”‚         HASH_JOIN         â”‚                                                                                                                                                 
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                                                 
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                                  
â”‚    l_suppkey=ps_suppkey   â”‚              â”‚                                                                                                                                  
â”‚    l_partkey=ps_partkey   â”‚              â”‚                                                                                                                                  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                                                                               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                                    
â”‚         PROJECTION        â”‚â”‚         HASH_JOIN         â”‚                                                                                                                    
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                                                    
â”‚         l_suppkey         â”‚â”‚           INNER           â”‚                                                                                                                    
â”‚         l_partkey         â”‚â”‚    ps_suppkey=s_suppkey   â”‚                                                                                                                    
â”‚         l_orderkey        â”‚â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        
â”‚      l_extendedprice      â”‚â”‚                           â”‚                                           â”‚                                                                        
â”‚         l_discount        â”‚â”‚                           â”‚                                           â”‚                                                                        
â”‚         l_quantity        â”‚â”‚                           â”‚                                           â”‚                                                                        
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚                                                                                                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚      R_DATAFRAME_SCAN     â”‚â”‚         PROJECTION        â”‚                             â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         data.frame        â”‚â”‚         ps_suppkey        â”‚                             â”‚         s_suppkey         â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚         ps_partkey        â”‚                             â”‚           n_name          â”‚                                                          
â”‚         l_orderkey        â”‚â”‚       ps_supplycost       â”‚                             â”‚                           â”‚                                                          
â”‚         l_partkey         â”‚â”‚                           â”‚                             â”‚                           â”‚                                                          
â”‚         l_suppkey         â”‚â”‚                           â”‚                             â”‚                           â”‚                                                          
â”‚         l_quantity        â”‚â”‚                           â”‚                             â”‚                           â”‚                                                          
â”‚      l_extendedprice      â”‚â”‚                           â”‚                             â”‚                           â”‚                                                          
â”‚         l_discount        â”‚â”‚                           â”‚                             â”‚                           â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
                             â”‚         HASH_JOIN         â”‚                             â”‚         HASH_JOIN         â”‚                                                          
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
                             â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           
                             â”‚    ps_partkey=p_partkey   â”‚              â”‚              â”‚  s_nationkey=n_nationkey  â”‚              â”‚                                           
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                        
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
                             â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚â”‚      R_DATAFRAME_SCAN     â”‚â”‚      R_DATAFRAME_SCAN     â”‚                             
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
                             â”‚         ps_suppkey        â”‚â”‚             #0            â”‚â”‚         data.frame        â”‚â”‚         data.frame        â”‚                             
                             â”‚         ps_partkey        â”‚â”‚                           â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
                             â”‚       ps_supplycost       â”‚â”‚                           â”‚â”‚         s_suppkey         â”‚â”‚        n_nationkey        â”‚                             
                             â”‚                           â”‚â”‚                           â”‚â”‚        s_nationkey        â”‚â”‚           n_name          â”‚                             
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                             â”‚      R_DATAFRAME_SCAN     â”‚â”‚           FILTER          â”‚                                                                                       
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                             â”‚         data.frame        â”‚â”‚  contains(CAST(p_name AS  â”‚                                                                                       
                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚     VARCHAR), 'green')    â”‚                                                                                       
                             â”‚         ps_partkey        â”‚â”‚                           â”‚                                                                                       
                             â”‚         ps_suppkey        â”‚â”‚                           â”‚                                                                                       
                             â”‚       ps_supplycost       â”‚â”‚                           â”‚                                                                                       
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
                                                          â”‚      R_DATAFRAME_SCAN     â”‚                                                                                       
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                          â”‚         data.frame        â”‚                                                                                       
                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
                                                          â”‚         p_partkey         â”‚                                                                                       
                                                          â”‚           p_name          â”‚                                                                                       
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
NULL
[38;5;246m# A tibble: 175 Ã— 3[39m
   nation  o_year sum_profit
   [3m[38;5;246m<chr>[39m[23m    [3m[38;5;246m<int>[39m[23m      [3m[38;5;246m<dbl>[39m[23m
[38;5;250m 1[39m ALGERIA   [4m1[24m992  45[4m6[24m[4m3[24m[4m6[24m849.
[38;5;250m 2[39m ALGERIA   [4m1[24m993  46[4m0[24m[4m4[24m[4m4[24m208.
[38;5;250m 3[39m ALGERIA   [4m1[24m994  48[4m6[24m[4m9[24m[4m4[24m008.
[38;5;250m 4[39m ALGERIA   [4m1[24m995  44[4m4[24m[4m0[24m[4m2[24m274.
[38;5;250m 5[39m ALGERIA   [4m1[24m996  48[4m2[24m[4m8[24m[4m5[24m483.
[38;5;250m 6[39m ALGERIA   [4m1[24m997  48[4m6[24m[4m1[24m[4m1[24m833.
[38;5;250m 7[39m ALGERIA   [4m1[24m998  27[4m1[24m[4m3[24m[4m6[24m900.
[38;5;250m 8[39m BRAZIL    [4m1[24m992  45[4m2[24m[4m8[24m[4m0[24m217.
[38;5;250m 9[39m BRAZIL    [4m1[24m993  45[4m7[24m[4m6[24m[4m6[24m604.
[38;5;250m10[39m BRAZIL    [4m1[24m994  44[4m8[24m[4m5[24m[4m4[24m219.
[38;5;246m# â€¦ with 165 more rows[39m
function () 
{
    l <- select(filter(select(lineitem, l_orderkey, l_returnflag, 
        l_extendedprice, l_discount), l_returnflag == "R"), l_orderkey, 
        l_extendedprice, l_discount)
    o <- select(filter(select(orders, o_orderkey, o_custkey, 
        o_orderdate), o_orderdate >= "1993-10-01", o_orderdate < 
        "1994-01-01"), o_orderkey, o_custkey)
    lo <- select(inner_join(l, o, by = c(l_orderkey = "o_orderkey")), 
        l_extendedprice, l_discount, o_custkey)
    lo_aggr <- summarise(group_by(mutate(lo, volume = l_extendedprice * 
        (1 - l_discount)), o_custkey), revenue = sum(volume))
    c <- select(customer, c_custkey, c_nationkey, c_name, c_acctbal, 
        c_phone, c_address, c_comment)
    loc <- inner_join(lo_aggr, c, by = c(o_custkey = "c_custkey"))
    locn <- inner_join(loc, select(nation, n_nationkey, n_name), 
        by = c(c_nationkey = "n_nationkey"))
    res <- head(arrange(select(locn, o_custkey, c_name, revenue, 
        c_acctbal, n_name, c_address, c_phone, c_comment), revenue), 
        20)
    res
}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚           TOP_N           â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚           Top 20          â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚    relation.revenue ASC   â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         PROJECTION        â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚         o_custkey         â”‚                                                                                       
â”‚           c_name          â”‚                                                                                       
â”‚          revenue          â”‚                                                                                       
â”‚         c_acctbal         â”‚                                                                                       
â”‚           n_name          â”‚                                                                                       
â”‚         c_address         â”‚                                                                                       
â”‚          c_phone          â”‚                                                                                       
â”‚         c_comment         â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         PROJECTION        â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚         o_custkey         â”‚                                                                                       
â”‚          revenue          â”‚                                                                                       
â”‚           c_name          â”‚                                                                                       
â”‚         c_acctbal         â”‚                                                                                       
â”‚          c_phone          â”‚                                                                                       
â”‚         c_address         â”‚                                                                                       
â”‚         c_comment         â”‚                                                                                       
â”‚           n_name          â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         HASH_JOIN         â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚  c_nationkey=n_nationkey  â”‚                                                                        â”‚              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                        â”‚                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         HASH_JOIN         â”‚                                                          â”‚      R_DATAFRAME_SCAN     â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚           INNER           â”‚                                                          â”‚         data.frame        â”‚
â”‚    o_custkey=c_custkey    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚                           â”‚                                           â”‚              â”‚        n_nationkey        â”‚
â”‚                           â”‚                                           â”‚              â”‚           n_name          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚       HASH_GROUP_BY       â”‚                             â”‚         PROJECTION        â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚             #0            â”‚                             â”‚         c_custkey         â”‚                             
â”‚          sum(#1)          â”‚                             â”‚        c_nationkey        â”‚                             
â”‚                           â”‚                             â”‚           c_name          â”‚                             
â”‚                           â”‚                             â”‚         c_acctbal         â”‚                             
â”‚                           â”‚                             â”‚          c_phone          â”‚                             
â”‚                           â”‚                             â”‚         c_address         â”‚                             
â”‚                           â”‚                             â”‚         c_comment         â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             
â”‚         PROJECTION        â”‚                             â”‚      R_DATAFRAME_SCAN     â”‚                             
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚         o_custkey         â”‚                             â”‚         data.frame        â”‚                             
â”‚           volume          â”‚                             â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                             
â”‚                           â”‚                             â”‚         c_custkey         â”‚                             
â”‚                           â”‚                             â”‚           c_name          â”‚                             
â”‚                           â”‚                             â”‚         c_address         â”‚                             
â”‚                           â”‚                             â”‚        c_nationkey        â”‚                             
â”‚                           â”‚                             â”‚          c_phone          â”‚                             
â”‚                           â”‚                             â”‚         c_acctbal         â”‚                             
â”‚                           â”‚                             â”‚         c_comment         â”‚                             
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         PROJECTION        â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚         o_custkey         â”‚                                                                                       
â”‚           volume          â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         PROJECTION        â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚      l_extendedprice      â”‚                                                                                       
â”‚         l_discount        â”‚                                                                                       
â”‚         o_custkey         â”‚                                                                                       
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                       
â”‚         HASH_JOIN         â”‚                                                                                       
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                                                       
â”‚           INNER           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                        
â”‚   l_orderkey=o_orderkey   â”‚              â”‚                                                                        
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                                                                                                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚         PROJECTION        â”‚â”‚         PROJECTION        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚             #0            â”‚â”‚             #0            â”‚                                                          
â”‚             #1            â”‚â”‚             #1            â”‚                                                          
â”‚             #2            â”‚â”‚                           â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚           FILTER          â”‚â”‚           FILTER          â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚      l_returnflag = R     â”‚â”‚ o_orderdate BETWEEN '1993 â”‚                                                          
â”‚                           â”‚â”‚-10-01'::DATE AND '199...  â”‚                                                          
â”‚                           â”‚â”‚          '::DATE          â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          
â”‚      R_DATAFRAME_SCAN     â”‚â”‚      R_DATAFRAME_SCAN     â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         data.frame        â”‚â”‚         data.frame        â”‚                                                          
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚                                                          
â”‚         l_orderkey        â”‚â”‚         o_orderkey        â”‚                                                          
â”‚      l_extendedprice      â”‚â”‚         o_custkey         â”‚                                                          
â”‚         l_discount        â”‚â”‚        o_orderdate        â”‚                                                          
â”‚        l_returnflag       â”‚â”‚                           â”‚                                                          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       
NULL
[38;5;246m# A tibble: 20 Ã— 8[39m
   o_custkey c_name  revenue c_acctbal n_name  c_address   c_phone c_comment    
       [3m[38;5;246m<int>[39m[23m [3m[38;5;246m<chr>[39m[23m     [3m[38;5;246m<dbl>[39m[23m     [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        
[38;5;250m 1[39m     [4m6[24m[4m4[24m663 Customâ€¦    861.    [4m9[24m292.  ARGENTâ€¦ TpDebaozkKâ€¦ 11-610â€¦ [38;5;246m"[39mgular ideasâ€¦
[38;5;250m 2[39m     [4m8[24m[4m4[24m998 Customâ€¦    904.    [4m8[24m815.  INDONEâ€¦ TyQ5km9qL8â€¦ 19-686â€¦ [38;5;246m"[39mrefully expâ€¦
[38;5;250m 3[39m     [4m2[24m[4m2[24m174 Customâ€¦    918.    [4m8[24m652.  BRAZIL  jkwK2wiPf9â€¦ 12-119â€¦ [38;5;246m"[39m cajole regâ€¦
[38;5;250m 4[39m      [4m8[24m876 Customâ€¦    941.     396.  ETHIOPâ€¦ kDPEdwW8Xxâ€¦ 15-282â€¦ [38;5;246m"[39mde of the eâ€¦
[38;5;250m 5[39m     [4m6[24m[4m8[24m098 Customâ€¦    967.    [4m9[24m005.  MOROCCO Oz9L,bHruYâ€¦ 25-413â€¦ [38;5;246m"[39mcies sleep â€¦
[38;5;250m 6[39m     [4m2[24m[4m2[24m225 Customâ€¦    981.    [4m5[24m721.  ETHIOPâ€¦ PfHcT,jJScâ€¦ 15-434â€¦ [38;5;246m"[39miously. finâ€¦
[38;5;250m 7[39m    [4m1[24m[4m0[24m[4m8[24m712 Customâ€¦    986.     837.  KENYA   kmSaUNm8dkâ€¦ 24-248â€¦ [38;5;246m"[39mgainst the â€¦
[38;5;250m 8[39m     [4m7[24m[4m2[24m314 Customâ€¦   [4m1[24m008.    [4m2[24m296.  MOROCCO RZYv9HI4eFâ€¦ 25-477â€¦ [38;5;246m"[39mly regular â€¦
[38;5;250m 9[39m     [4m4[24m[4m3[24m058 Customâ€¦   [4m1[24m015.     -[31m23[39m[31m.[39m[31m4[39m KENYA   yKxt6hqb8PC 24-734â€¦ [38;5;246m"[39mbold, even â€¦
[38;5;250m10[39m    [4m1[24m[4m2[24m[4m6[24m217 Customâ€¦   [4m1[24m035.    [4m2[24m861.  UNITEDâ€¦ bHX5Y2VQ4Aâ€¦ 34-685â€¦ [38;5;246m"[39mhinly expreâ€¦
[38;5;250m11[39m    [4m1[24m[4m0[24m[4m6[24m537 Customâ€¦   [4m1[24m036.    [4m2[24m745.  CANADA  OpCBWFtGQpV 13-619â€¦ [38;5;246m"[39min pinto beâ€¦
[38;5;250m12[39m    [4m1[24m[4m4[24m[4m6[24m230 Customâ€¦   [4m1[24m044.    [4m8[24m237.  EGYPT   ,X6hbOuWTUâ€¦ 14-535â€¦ [38;5;246m"[39mafter the eâ€¦
[38;5;250m13[39m     [4m4[24m[4m0[24m978 Customâ€¦   [4m1[24m056.    -[31m104[39m[31m.[39m  INDIA   gKmMcgLkaQâ€¦ 18-667â€¦ [38;5;246m"[39musly final â€¦
[38;5;250m14[39m     [4m3[24m[4m3[24m880 Customâ€¦   [4m1[24m056.    [4m9[24m278.  IRAQ    68MgIxX5leâ€¦ 21-148â€¦ [38;5;246m"[39ms sleep carâ€¦
[38;5;250m15[39m      [4m1[24m375 Customâ€¦   [4m1[24m062.    [4m2[24m011.  KENYA   GBgJ4UKragâ€¦ 24-620â€¦ [38;5;246m"[39mrequests! eâ€¦
[38;5;250m16[39m     [4m6[24m[4m6[24m497 Customâ€¦   [4m1[24m072.    [4m8[24m682.  IRAQ    qIx3cTyt9Nâ€¦ 21-409â€¦ [38;5;246m"[39m; quickly râ€¦
[38;5;250m17[39m    [4m1[24m[4m1[24m[4m8[24m070 Customâ€¦   [4m1[24m076.    [4m4[24m494.  MOROCCO wdT1PzX gpâ€¦ 25-463â€¦ [38;5;246m"[39mole carefulâ€¦
[38;5;250m18[39m     [4m3[24m[4m9[24m247 Customâ€¦   [4m1[24m076.    [4m7[24m710.  JORDAN  0J1r2hapw7â€¦ 23-202â€¦ [38;5;246m"[39mare furiousâ€¦
[38;5;250m19[39m     [4m2[24m[4m0[24m614 Customâ€¦   [4m1[24m078.    [4m6[24m767.  FRANCE  0ar8dXwvjvâ€¦ 16-124â€¦ [38;5;246m"[39mss the reguâ€¦
[38;5;250m20[39m     [4m9[24m[4m0[24m542 Customâ€¦   [4m1[24m086.    [4m8[24m715.  SAUDI â€¦ e PacvMjNIâ€¦ 30-809â€¦ [38;5;246m"[39mlly across â€¦
> 
